<!DOCTYPE html>
<html dir="rtl" lang="ar">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>سلة العراق للتجارة والتوزيع</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&amp;display=swap" rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        primary: "#3b82f6",
                        "background-light": "#f8fafc",
                        "background-dark": "#0f172a",
                    },
                    fontFamily: {
                        display: ["Cairo", "sans-serif"],
                    },
                    borderRadius: {
                        DEFAULT: "0.75rem",
                    },
                },
            },
        };
    </script>

    <style>
        :root {
            --primary-color: #f7c300;
            /* الأصفر من الشعار */
            --secondary-color: #4a4a4a;
            /* الرمادي الداكن من الشعار */
            --bg-light: #f9f9f9;
        }

        body {
            font-family: 'Cairo', sans-serif;
            /* تغيير الخط لكل الموقع */
            background-color: var(--bg-light);
            color: var(--secondary-color);
        }

        @media (max-width: 768px) {
            header {
                padding-top: 0.5rem;
                padding-bottom: 0.5rem;
            }
        }

        /* تنسيق أزرار الأقسام (Pills) لتشبه الألوان المطلوبة */
        .category-btn.active {
            background-color: var(--primary-color) !important;
            border-color: var(--primary-color) !important;
            color: #000 !important;
        }

        /* تنسيق شريط البحث */
        #searchInput {
            border-radius: 50px;
            border: 2px solid #eee;
            padding-right: 45px;
        }


        /* تنسيق السعر */
        .price-tag {
            color: var(--secondary-color);
            font-weight: 800;
        }

        .discount-price {
            color: #e63946;
            /* لون أحمر هادئ للخصم */
        }
    </style>
</head>

<body class="bg-slate-50">

    <header class="bg-white/80 shadow-sm sticky top-0 z-50 backdrop-blur-md">
        <div class="container mx-auto px-4 py-3">

            <div class="flex items-center justify-between md:justify-start gap-4 mb-3 md:mb-0">

                <div class="flex items-center gap-3">
                    <img src="https://i.ibb.co/F4gw7BnV/logo.png" alt="Logo" class="h-12 w-auto md:h-16">
                    <div>
                <h1 class="text-2xl font-bold text-secondary-color" style="color: var(--secondary-color)">سلة العراق </h1>
                <p class="text-sm text-gray-500">لتجارة وتوزيع المنتجات الغذائية والاستهلاكية</p>
            </div>
                </div>

            </div>

            <div class="md:absolute md:left-1/2 md:top-1/2 md:-translate-x-1/2 md:-translate-y-1/2 w-full md:w-96">
                <div class="relative group">
                    <span
                        class="absolute inset-y-0 right-4 flex items-center text-gray-400 transition-colors">
                        <span class="material-icons-outlined">search</span>
                    </span>
                    <input type="text" id="searchInput" onkeyup="filterProducts()" placeholder="ابحث عن منتج..."
                        class="w-full py-2.5 md:py-3 pr-11 pl-4 bg-gray-50 border-2 border-gray-100 rounded-2xl md:rounded-full text-sm focus:bg-white focus:ring-2 focus:ring-yellow-400 outline-none transition-all text-right shadow-sm">
                </div>
            </div>

        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 py-8">
        <div id="categoryBar" class="flex flex-wrap justify-center gap-2 mb-8">
        </div>
        <div id="productsGrid" class="grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
            <div class="col-span-full text-center py-10 text-slate-500">جاري تحميل المنتجات...</div>
        </div>
    </main>
    <style>
        .image-container {
            width: 100%;
            height: 250px;
            overflow: hidden;
            position: relative;
        }

        .image-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .product-card:hover img {
            transform: scale(1.08);
        }

        /* تنسيق أزرار التنقل */
        .page-btn {
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .page-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }
    </style>

    <div class="flex justify-center items-center gap-3 mt-12 mb-12">
        <div id="paginationButtons" class="flex items-center gap-2">
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>

    <script>
        // 1. الإعدادات والمتغيرات العامة
        const SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQLyL8folfxpC5EsPlkv2vWBNROY064cbM3tbJ0bArIfJTWe3Fi1KB0SLMLiE8PLto32lGrT6Gzcr56/pub?output=csv";

        let allProducts = [];      // لتخزين كل البيانات الأصلية
        let filteredProducts = []; // لتخزين البيانات بعد الفلترة والبحث
        let currentPage = 1;       // الصفحة الحالية
        const itemsPerPage = 12;   // عدد المنتجات في كل صفحة
        let currentCategory = "الكل"; // القسم المختار حالياً

        // 2. تشغيل جلب البيانات عند تحميل الصفحة
        window.onload = loadDataFromSheet;

        async function loadDataFromSheet() {
            Papa.parse(SHEET_URL, {
                download: true,
                header: true,
                complete: function (results) {
                    // تصفية السطور الفارغة من ملف جوجل
                    allProducts = results.data.filter(row => row['اسم المنتج'] && row['اسم المنتج'].trim() !== "");
                    filteredProducts = [...allProducts];

                    createCategoryButtons(); // توليد أزرار الأقسام
                    renderPage(1);           // عرض الصفحة الأولى
                },
                error: function (err) {
                    console.error("خطأ في تحميل البيانات:", err);
                }
            });
        }

        // 3. وظيفة توليد أزرار الأقسام ديناميكياً
        function createCategoryButtons() {
            const container = document.getElementById('categoryBar');
            if (!container) return;

            // استخراج الأقسام الفريدة
            const uniqueCategories = ["الكل", ...new Set(allProducts.map(p => p['الفئة']).filter(c => c))];

            container.innerHTML = uniqueCategories.map(cat => `
            <button onclick="setCategory('${cat}')" 
                class="px-5 py-2 rounded-full border transition-all font-bold text-sm mb-2
                ${currentCategory === cat ? 'bg-yellow-400 text-white border-yellow-400 shadow-md' : 'bg-white text-slate-600 border-slate-200 hover:border-yellow-400'}">
                ${cat}
            </button>
        `).join('');
        }

        // 4. وظيفة تغيير القسم
        function setCategory(cat) {
            currentCategory = cat;
            createCategoryButtons(); // لتحديث شكل الزر النشط
            filterProducts();        // إعادة تصفية المنتجات
        }

        // 5. وظيفة البحث والفلترة المشتركة
        function filterProducts() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();

            filteredProducts = allProducts.filter(product => {
                const name = (product['اسم المنتج'] || "").toLowerCase();
                const category = (product['الفئة'] || "").toLowerCase();

                // شرط القسم
                const matchesCategory = (currentCategory === "الكل" || product['الفئة'] === currentCategory);
                // شرط البحث
                const matchesSearch = name.includes(searchTerm) || category.includes(searchTerm);

                return matchesCategory && matchesSearch;
            });

            currentPage = 1; // العودة للصفحة الأولى دائماً عند البحث أو التغيير
            renderPage(1);
        }

        function renderPage(page) {
            currentPage = page;
            const grid = document.getElementById('productsGrid');
            const start = (page - 1) * itemsPerPage;
            const end = start + itemsPerPage;
            const productsToDisplay = filteredProducts.slice(start, end);

            const formatPrice = (val) => {
                if (!val || val.trim() === "") return null;
                let num = parseFloat(val.toString().replace(/[^\d.]/g, ''));
                if (isNaN(num)) return null;
                return num.toLocaleString('en-US');
            };

            grid.innerHTML = productsToDisplay.map(product => {
                const price = formatPrice(product['السعر']);
                const discPrice = formatPrice(product['السعر بعد العرض']);
                const hasDisc = discPrice && discPrice !== price;

                return `
        <div class="product-card bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden flex flex-col hover:shadow-lg transition-all duration-300">
            <div class="relative w-full h-64 overflow-hidden bg-slate-50">
                <img src="${fixImageUrl(product['الصورة'])}" 
                     style="width:100%; height:100%; object-fit:cover;"
                     onerror="this.src='https://via.placeholder.com/400x400?text=No+Image'">
                ${hasDisc ? `<div class="absolute top-3 right-3 bg-red-600 text-white text-[10px] font-bold px-3 py-1 rounded-full shadow-md">عرض خاص</div>` : ''}
            </div>
            <div class="p-5 flex-grow flex flex-col text-right">
                <span class="text-yellow-400 text-[10px] font-bold mb-1 uppercase">${product['الفئة'] || ''}</span>
                <h3 class="font-bold text-slate-800 text-md mb-2 leading-tight">${product['اسم المنتج']}</h3>
                <div class="mt-auto">
                    ${hasDisc ? `
                        <div class="text-slate-400 line-through text-[11px] mb-1">${price} د.ع</div>
                        <div class="text-xl font-black text-red-600">${discPrice} <span class="text-xs font-normal">د.ع</span></div>
                    ` : `
                        <div class="text-xl font-black text-slate-900">${price} <span class="text-xs font-normal">د.ع</span></div>
                    `}
                </div>
            </div>
        </div>
            `;
            }).join('');

            updatePaginationControls();
        }

        // 7. تحديث أزرار التنقل (السابق، الأرقام، التالي)
        function updatePaginationControls() {
            const container = document.getElementById('paginationButtons');
            if (!container) return;

            const totalPages = Math.ceil(filteredProducts.length / itemsPerPage);

            if (totalPages <= 1) {
                container.innerHTML = "";
                return;
            }

            let html = '';

            // زر السابق (السهم لليمين لأن الموقع RTL)
            html += `
            <button onclick="changePage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''} 
                class="p-2 rounded-xl border border-slate-200 bg-white text-slate-600 disabled:opacity-30">
                <span class="material-icons-outlined">chevron_right</span>
            </button>
        `;

            // أرقام الصفحات
            for (let i = 1; i <= totalPages; i++) {
                html += `
                <button onclick="renderPage(${i})" 
                    class="w-10 h-10 rounded-xl font-bold transition-all 
                    ${i === currentPage ? 'bg-yellow-400 text-white shadow-md' : 'bg-white text-slate-500 border border-slate-100 hover:bg-slate-50'}">
                    ${i}
                </button>
            `;
            }

            // زر التالي
            html += `
            <button onclick="changePage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''} 
                class="p-2 rounded-xl border border-slate-200 bg-white text-slate-600 disabled:opacity-30">
                <span class="material-icons-outlined">chevron_left</span>
            </button>
        `;

            container.innerHTML = html;
        }

        function changePage(newPage) {
            const totalPages = Math.ceil(filteredProducts.length / itemsPerPage);
            if (newPage >= 1 && newPage <= totalPages) {
                renderPage(newPage);
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        // 8. وظيفة إصلاح روابط الصور (جوجل درايف و ImgBB)
        function fixImageUrl(url) {
            if (!url) return '';
            let u = url.trim();
            // معالجة روابط جوجل درايف
            if (u.includes('drive.google.com')) {
                let id = u.split('/d/')[1]?.split('/')[0] || u.split('id=')[1];
                return `https://drive.google.com/uc?export=view&id=${id}`;
            }
            // معالجة روابط ImgBB (الصفحات غير المباشرة)
            if (u.includes('ibb.co') && !u.match(/\.(jpg|jpeg|png|webp|gif)$/)) {
                let id = u.split('/').pop();
                return `https://i.ibb.co/${id}/${id}.jpg`;
            }
            return u;
        }
    </script>
    <footer class="bg-[#4a4a4a] text-white pt-12 pb-6 mt-20">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-10 border-b border-gray-600 pb-10">

                <div class="text-right">
                    <div class="flex items-center gap-4">
                        <img src="https://i.ibb.co/F4gw7BnV/logo.png" alt="سلة العراق" class="h-16 w-auto">
                        <div>
                <h1 class="text-2xl font-bold text-secondary-color">سلة العراق</h1>
                
            </div>
                    </div>

                    <p class="text-gray-300 text-sm leading-relaxed mt-4">
                        نحن متخصصون في تجارة وتوزيع كافة المنتجات الغذائية والاستهلاكية بأعلى معايير الجودة لتلبية
                        احتياجات السوق العراقي.
                    </p>
                </div>

                <div class="text-right">
                    <h3 class="text-lg font-bold mb-4 text-[#f7c300]">روابط سريعة</h3>
                    <ul class="space-y-2 text-sm text-gray-300">
                        <li><a href="#" class="hover:text-[#f7c300] transition-colors">الرئيسية</a></li>
                        <li><a href="#productsGrid" class="hover:text-[#f7c300] transition-colors">كل المنتجات</a></li>
                        <li><a href="#" class="hover:text-[#f7c300] transition-colors">أحدث العروض</a></li>
                    </ul>
                </div>

                <div class="text-right">
                    <h3 class="text-lg font-bold mb-4 text-[#f7c300]">تواصل معنا</h3>
                    <div class="flex flex-col gap-3 text-sm text-gray-300">
                        <div class="flex items-center gap-2 justify-start">
                            <span class="material-icons-outlined text-[#f7c300]">phone</span>
                            <span dir="ltr">+964 000 000 0000</span>
                        </div>
                        <div class="flex items-center gap-2 justify-start">
                            <span class="material-icons-outlined text-[#f7c300]">location_on</span>
                            <span>العراق - بغداد</span>
                        </div>
                        <div class="flex items-center gap-2 justify-start">
                            <span class="material-icons-outlined text-[#f7c300]">email</span>
                            <span>info@sallat-iraq.com</span>
                        </div>
                    </div>
                </div>

            </div>

            <div class="text-center pt-6 text-xs text-gray-400">
                <p>© 2026 سلة العراق للتجارة. جميع الحقوق محفوظة.</p>
            </div>
        </div>
    </footer>
</body>


</html>


